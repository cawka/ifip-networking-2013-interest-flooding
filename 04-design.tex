\section{Interest flooding mitigation methods}
\label{sec:design}

% Points what should be here:
% - What can be done (in general) to mitigate flooding attack
% - Which building blocks NDN architecture gives to mitigate Interest flooding attacks: Interest limits, ability to measure Interest satisfaction performance (Interest satisfaction stats)
% - Methods to set these limits: static/dynamic
% - Methods how limits can be applied: best-effort (fifo), "fair" queuing, probabilistic
% - Reference to caching: we don't consider it here, but caching provides additional level of protection, especially for certain types of attacks

% Our definition of attack mitigation is that good clients are still able to access data on the producer.

In this section we present several methods to mitigate Interest flooding attacks in NDN, featuring different degrees of implementation complexity, as well as different degrees of effectiveness.

%   - Naive approach to Interest Limits (that is called physical limits everywhere else)
%     Example how this can be implemented in a simple way
%     Baseline solution
%   - Interest limits with "fair" queuing
%     Improving problem of simple limits (no single face can dominate), but doesn't solve the proble

% - Attack mitigation
%   - Per-incoming interface Interest statistics

%   - Dynamic Interests limit adjustments

%   - Probabilistic Interest accept

Our methods to mitigate Interest flooding attack rely on the fundamental principle of the NDN architecture: the flow balance between Interest and Data packets: one Interest packet (the only communication initiator) can be satisfied with at most one Data packet.
Because NDN is host-to-host architecture (as opposed to end-to-end in the current IP Internet), the flow balance principle allow any entity on the network, end-hosts and routers, control what and how much Data they want to receive.
Therefore, any node can limit the number of forwarded Interests, effectively limiting the amount of the retrieved Data.
At the same time, each forwarded Interest can be used to build up various data plane performance statistics, such as per-incoming interface ratios of satisfied Interests.

\subsection{Na\"{i}ve attack mitigation}

% In a normal network operation, the size of Interests packets is supposed to be significantly smaller than the size of the requested Data.

% All communication in NDN network is host-to-host and receiver-driven.

The most obvious and na\"{i}ve method to mitigate the Interest flooding attack is to limit the number of forwarded Interests out of each interface. 
That is, if it is known that the amount of already requested data ($=$~amount of forwarded Interests) can fully utilize the downstream link, an NDN node---either an end-user or an NDN router---has absolutely no point in forwarding new incoming Interests and creating corresponding PIT entries.
For example, if a router A on Fig.~\ref{fig:flooding example} already forwarded 125 Interests requesting 1000-byte Data packets, any new incoming Interests can be almost safely dropped, provided the link capacity between A--B is 100~Mbps and delay is 10~ms.
In other words, 125 Data packets returned by router B will fully utilize the link ($125 \times 1000 \mathrm{~bytes} \approx 10\mathrm{~ms} \times 100\mathrm{~Mbps}$) and any excess Data would be dropped.

\subsubsection{\textbf{Interest limits (physical limits)}}
\label{sec:physical limits}

\input{algos/physical-limits.tex}

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{\textbf{Physical limits with per-interface fairness}}
\label{sec:queuing}

\input{algos/fair-queueing.tex}

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Intelligent attack mitigation}
\label{sec:intelligent mitigating}

While the Interest limit is the key building block to suppress mechanisms of the Interest flooding attack, legitimate Interests need to be somehow prioritized and malicious Interests need to be somehow penalized in order to completely suppress the attack.
That is, instead of processing Interests always based on the first-in-first-serve rule, NDN routers need some basis to treat the incoming Interests differently.
Thus, the primary task in bringing intelligence to the Interest flooding attack mitigation is to proactively distinguish between legitimate and malicious Interests.

To achieve such an Interest differentiation we can leverage another unique feature of the stateful forwarding in NDN---namely, the guaranteed symmetric flow of Interest and Data packets.
In other words, NDN guarantees that a forwarded Interest would always results in receiving a corresponding Data, provided such Data exists and Interest/Data packets were not lost on the way.
Therefore, all Interests that result in Data return can be considered legitimate, while the ones that always timeout should be deemed as malicious.\footnote{Recall that in order to maximize effect of the Interest flooding attack, an adversary expresses a large volume of junk Interests (see Section~\ref{sec:interest flooding}).  Implications of other types of attacks are discussed in Section~\ref{sec:discussion}.}

Unfortunately, the timeout-based differentiation is reactive by nature: one cannot know in advance that an Interest would timeout or bring Data back.
What we can do proactively is to keep an up-to-date statistics of Interests satisfaction ratios (number of forwarded versus number of satisfied Interests), and use this statistics to project outcomes for new Interests.
For example, maintaining independent Interest satisfaction ratio statistics for each incoming interface can be enough to estimate whether an Interest received from a neighbor will bring Data or time out.
Statistics can also be kept at more granular levels (e.g., per outgoing interface, per prefix, etc.), which can further improve the estimation quality.

The devil is always in the details.
From the one hand, such statistics needs to start penalizing adversaries as soon as possible (i.e., negative stats should build up fast).
On the other hand, the positive statistics should not deteriorate too fast (i.e., positive stats should be relatively long-term).
Our preliminary experiments showed that the standard exponentially weighted moving average, performed once a second with $\alpha$ coefficient $e^{-1/30}$, approximately corresponding to a 30-second averaging window, provides a good balance between the two contradictory requirements.

% \subsubsection{\textbf{Data plane performance tracking}}
% \label{sec:stats}

\input{algos/stats.tex}

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{\textbf{Probabilistic Interest accept}}
\label{sec:probabilistic}

\input{algos/probabilistic.tex}

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{\textbf{Dynamic limits}}
\label{sec:dynamic limits}

\input{algos/dynamic-limits.tex}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "paper"
%%% End: 
