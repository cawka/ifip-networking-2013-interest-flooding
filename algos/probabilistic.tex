\subsection{Probabilistic Interest accept algorithm}
\label{sec:probabilistic}

The basic idea of the dynamic limits algorithm is to treat differently (accept different amounts of) Interests belonging to different classes.
The high-level implementation of this in the dynamic limits algorithm is based explicit limits that are announced to each neighbor of the node.
While the control overhead generated by such announcements can be manageable (i.e., similar to the routing updates in dynamic routing protocols, limit announcements can be paced out, as well as generated only when change is detected), some can consider such overhead undesirable.

The same goal of differential treatment of Interests, and in particular ``suppression'' of malicious Interests, can also achieved in a slightly different way, which does not require any additional communication between routers.
Instead of announce and explicitly apply limits on the number of accepted Interests for each incoming interface (and optionally for each prefix in FIB), a node can accept new incoming Interests based on some probabilistic model, which incorporates satisfaction ratios for the desired Interest classes.
For example, this could be a simple uniform distribution, where the satisfaction ratio directly defines probability to accept or reject an incoming Interests (see Pseudocode~\ref{alg:probabilistic model}).
For simplicity, for the example we are using Interest differentiation only per incoming interface, but the algorithm can be generalized to more granular Interest classes.

\floatname{algorithm}{Pseudocode}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{algorithm}[h]
\caption{Probabilistic model}
\label{alg:probabilistic model}
\begin{algorithmic}[1]

\Function{InInterest}{Interest $i$, InFace $if$}

    \State{} \Comment{Use uniform probability distribution model $P(X)$}
    \State{} \Comment{$P(X) : \forall x \in [0,1] \Rightarrow P(x) = x$}
    
    \For{\textbf{each} OutFace $of$ \textbf{in} ForwardingDecision($i,if$)}
        \State $s \leftarrow if$.GetSatisfactionRatio()
        \If{$s \in [0,1]$} \Comment{A valid stats exists}
            \State Stop processing with probability $P(s)$
        \EndIf
        \If{$of$ is under physical limits}
            \State Forward($i$, $of$)
        \EndIf
    \EndFor
\EndFunction

\end{algorithmic}
\end{algorithm}

The definition of the probabilistic Interest accept is very straightforward and seems to be trivial to implement.
However, there are a couple of implementation caveats that complicate matters.
Note that there is a condition (line 6 on Pseudocode~\ref{alg:probabilistic mode}) to check if there is a valid statistics point.
This condition is extremely important, because it first provides a basis to distinguish between known facts (i.e., good or bad satisfaction ratio for the incoming interface) and unknown facts (e.g., the first time an Interests arrives on the interfaces).
Second, it gives an opportunity to recover from a bad history (history of unsatisfied Interests) after malicious Interests are ceased to flow in.
Essentially, this recovery relies on statistics module to perform time-based invalidation of historical data (timely, but not too quickly\footnote{Otherwise, attackers may send short bursts of malicious Interests, successfully avoiding differential Interest treatment}).
As described in Section~\ref{sec:stats}, we are currently experimenting with the exponential statistics degradation, while we also planning to apply different approaches in the future.


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../paper"
%%% End: 
